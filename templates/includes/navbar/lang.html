{# templates/includes/navbar/lang.html #}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
{% get_available_languages as LANGUAGES %}
{% get_language_info_list for LANGUAGES as langs %}

<div class="dropdown">
  <a class="nav-link dropdown-toggle d-inline-flex align-items-center gap-1"
     href="#" id="langMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <i class="bi bi-translate"></i> {{ LANGUAGE_CODE|upper }}
  </a>
  <div class="dropdown-menu dropdown-menu-end" aria-labelledby="langMenu">
    {% for l in langs %}
      <form class="px-3 py-1" action="{% url 'set_language' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.get_full_path }}">
        <button type="submit" name="language" value="{{ l.code }}"
                class="dropdown-item d-flex justify-content-between align-items-center{% if l.code == LANGUAGE_CODE %} active{% endif %}">
          {{ l.name_local }} <span class="ms-2 small text-muted">{{ l.code|upper }}</span>
        </button>
      </form>
    {% endfor %}
  </div>
</div>
